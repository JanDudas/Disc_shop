<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sysevent_script_action">
    <sysevent_script_action action="DELETE">
        <active>false</active>
        <condition_script/>
        <description/>
        <event_name>x_1461179_disk_sho.lowCountDiscRecords</event_name>
        <name>Create CSV file</name>
        <order>100</order>
        <script><![CDATA[var Headers = ["Number","Caller","Short Desc","Assignment Group", "Assigned To"];
var fileName = 'Incidents.csv';
var csvData = ''; //The variable csvData will contain a string which is used to build the CSV file contents
for (var i = 0; i < Headers.length; i++) { //Build the Headers
	csvData = csvData + '"' + Headers[i] + '"' + ',';
}
csvData = csvData+"\r\n"; // Is a new line = \n linux AND \r\n? in Windows

var gr = new GlideRecord("incident");
gr.addActiveQuery();
gr.query();
while(gr.next()) {
	csvData = csvData + '"' + gr.number + '",' + '"' + gr.caller_id.getDisplayValue() + '",' + '"' + gr.short_description+'",' + '"' + gr.assignment_group.getDisplayValue() + '",' + '"' + gr.assigned_to.getDisplayValue() + '"';
	csvData = csvData+"\r\n";
}

//attach the file to a record.
var grRec = new GlideRecord("incident");  
grRec.addQuery("sys_id","54c5bd96836ada90fc9154d6feaad36f");
grRec.query();
if(grRec.next()){
	var grAttachment = new GlideSysAttachment();
	grAttachment.write(grRec, fileName, 'application/csv',csvData);
}]]></script>
        <synchronous>false</synchronous>
        <sys_class_name>sysevent_script_action</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2024-12-23 12:11:58</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_domain_path>/</sys_domain_path>
        <sys_id>8783289b83e21614fc9154d6feaad304</sys_id>
        <sys_mod_count>3</sys_mod_count>
        <sys_name>Create CSV file</sys_name>
        <sys_overrides/>
        <sys_package display_value="Disc shop" source="x_1461179_disk_sho">ee28f9b783161a50fc9154d6feaad3bd</sys_package>
        <sys_policy/>
        <sys_scope display_value="Disc shop">ee28f9b783161a50fc9154d6feaad3bd</sys_scope>
        <sys_update_name>sysevent_script_action_8783289b83e21614fc9154d6feaad304</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2024-12-25 09:46:45</sys_updated_on>
    </sysevent_script_action>
    <sys_es_latest_script action="DELETE">
        <id>8783289b83e21614fc9154d6feaad304</id>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2024-12-23 12:11:57</sys_created_on>
        <sys_id>73a3e01783661614fc9154d6feaad3a3</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2024-12-23 12:11:57</sys_updated_on>
        <table>sysevent_script_action</table>
        <use_es_latest>true</use_es_latest>
    </sys_es_latest_script>
    <sys_update_version action="INSERT_OR_UPDATE">
        <action>DELETE</action>
        <application display_value="Disc shop">ee28f9b783161a50fc9154d6feaad3bd</application>
        <file_path/>
        <instance_id>e9ec096d1bdef1107d9d2f8dee4bcb4b</instance_id>
        <instance_name>dev203221</instance_name>
        <name>sysevent_script_action_8783289b83e21614fc9154d6feaad304</name>
        <payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update sys_domain="global" table="sysevent_script_action"&gt;&lt;sysevent_script_action action="INSERT_OR_UPDATE"&gt;&lt;active&gt;false&lt;/active&gt;&lt;condition_script/&gt;&lt;description/&gt;&lt;event_name&gt;x_1461179_disk_sho.lowCountDiscRecords&lt;/event_name&gt;&lt;name&gt;Create CSV file&lt;/name&gt;&lt;order&gt;100&lt;/order&gt;&lt;script&gt;&lt;![CDATA[var Headers = ["Number","Caller","Short Desc","Assignment Group", "Assigned To"];
var fileName = 'Incidents.csv';
var csvData = ''; //The variable csvData will contain a string which is used to build the CSV file contents
for (var i = 0; i &lt; Headers.length; i++) { //Build the Headers
	csvData = csvData + '"' + Headers[i] + '"' + ',';
}
csvData = csvData+"\r\n"; // Is a new line = \n linux AND \r\n? in Windows

var gr = new GlideRecord("incident");
gr.addActiveQuery();
gr.query();
while(gr.next()) {
	csvData = csvData + '"' + gr.number + '",' + '"' + gr.caller_id.getDisplayValue() + '",' + '"' + gr.short_description+'",' + '"' + gr.assignment_group.getDisplayValue() + '",' + '"' + gr.assigned_to.getDisplayValue() + '"';
	csvData = csvData+"\r\n";
}

//attach the file to a record.
var grRec = new GlideRecord("incident");  
grRec.addQuery("sys_id","54c5bd96836ada90fc9154d6feaad36f");
grRec.query();
if(grRec.next()){
	var grAttachment = new GlideSysAttachment();
	grAttachment.write(grRec, fileName, 'application/csv',csvData);
}]]&gt;&lt;/script&gt;&lt;synchronous&gt;false&lt;/synchronous&gt;&lt;sys_class_name&gt;sysevent_script_action&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2024-12-23 12:11:58&lt;/sys_created_on&gt;&lt;sys_domain&gt;global&lt;/sys_domain&gt;&lt;sys_domain_path&gt;/&lt;/sys_domain_path&gt;&lt;sys_id&gt;8783289b83e21614fc9154d6feaad304&lt;/sys_id&gt;&lt;sys_mod_count&gt;3&lt;/sys_mod_count&gt;&lt;sys_name&gt;Create CSV file&lt;/sys_name&gt;&lt;sys_overrides/&gt;&lt;sys_package display_value="Disc shop" source="x_1461179_disk_sho"&gt;ee28f9b783161a50fc9154d6feaad3bd&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_scope display_value="Disc shop"&gt;ee28f9b783161a50fc9154d6feaad3bd&lt;/sys_scope&gt;&lt;sys_update_name&gt;sysevent_script_action_8783289b83e21614fc9154d6feaad304&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2024-12-25 09:46:45&lt;/sys_updated_on&gt;&lt;/sysevent_script_action&gt;&lt;sys_es_latest_script action="INSERT_OR_UPDATE"&gt;&lt;id&gt;8783289b83e21614fc9154d6feaad304&lt;/id&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2024-12-23 12:11:57&lt;/sys_created_on&gt;&lt;sys_id&gt;73a3e01783661614fc9154d6feaad3a3&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2024-12-23 12:11:57&lt;/sys_updated_on&gt;&lt;table&gt;sysevent_script_action&lt;/table&gt;&lt;use_es_latest&gt;true&lt;/use_es_latest&gt;&lt;/sys_es_latest_script&gt;&lt;/record_update&gt;</payload>
        <payload_hash>-1076429312</payload_hash>
        <record_name>Create CSV file</record_name>
        <reverted_from/>
        <source>d9c7d1d183665250fc9154d6feaad3a4</source>
        <source_table>sys_update_set</source_table>
        <state>previous</state>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2024-12-25 09:46:45</sys_created_on>
        <sys_id>8ca5d6b783eed254fc9154d6feaad304</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_recorded_at>193fd36289d0000001</sys_recorded_at>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2024-12-25 09:46:45</sys_updated_on>
        <type>Script Action</type>
        <update_guid>80a5d6b7a8eed2540f35cb6cda44fe04</update_guid>
        <update_guid_history>80a5d6b7a8eed2540f35cb6cda44fe04:-1076429312,b4d62097a3a616148c46c88cb1cda07c:-663484048,f0d4e41b41e216148c8efca755eda502:218910790,40b3e0179a66161470b8148d4a4a14d5:-870004948</update_guid_history>
    </sys_update_version>
    <sys_metadata_delete action="INSERT_OR_UPDATE">
        <sys_audit_delete/>
        <sys_class_name>sys_metadata_delete</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2024-12-25 19:41:19</sys_created_on>
        <sys_db_object display_value="" name="sysevent_script_action">sysevent_script_action</sys_db_object>
        <sys_id>0731ad7148014689a31403001e31c7b9</sys_id>
        <sys_metadata>8783289b83e21614fc9154d6feaad304</sys_metadata>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>Create CSV file</sys_name>
        <sys_package display_value="Disc shop" source="x_1461179_disk_sho">ee28f9b783161a50fc9154d6feaad3bd</sys_package>
        <sys_parent/>
        <sys_policy/>
        <sys_scope display_value="Disc shop">ee28f9b783161a50fc9154d6feaad3bd</sys_scope>
        <sys_scope_delete display_value="">0fdb8dfa0cfa4d2c84d33507d7f9a971</sys_scope_delete>
        <sys_update_name>sysevent_script_action_8783289b83e21614fc9154d6feaad304</sys_update_name>
        <sys_update_version display_value="sysevent_script_action_8783289b83e21614fc9154d6feaad304">8ca5d6b783eed254fc9154d6feaad304</sys_update_version>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2024-12-25 19:41:19</sys_updated_on>
    </sys_metadata_delete>
</record_update>
